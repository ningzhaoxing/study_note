
# 讲述实习项目

1. 在实习中遇到的挑战点以及是怎么解决的？
- 挑战点：
	1. 不熟悉模型设计流程
	2. 接触的业务概念多且比较难理解
	3. 如何通过模型设计兼容大部分第三方的事件机制，同时保证模型业务语义、职责边界的清晰明确，易于后续的维护扩展
	这些都需要解决的问题实际上需要在一周内完成。
- 怎么解决：
	1. 向 mt 了解熟悉模型设计的大致流程，包括分析调研第三方事件机制、目前的模型功能，明确需要解决的问题之后，设计模型方案。以及看了其他模型设计的文档，注意下在文档中需要重点表达的内容。
	2. 这个主要着重去看了此次需求所重点涉及的模型概念。也就是 PollingTrigger 和 InstantTrigger 的模型设计文档， 在基本理清模型概念后，再从使用者的角度去低代码开发 Trigger 来加深对概念的理解。之后再去看代码理清不太明白的部分地方的细节。最后感觉差不多了，找项目负责人去讲一遍，然后看看还有没有什么地方理解的有偏差。
	3. 前两个问题解决后，就开始进行模型方案设计。我觉得比较难的也是这个地方，刚开始给模型起名字都比较犯难哈哈。刚开始项目负责人希望我在 PollingTrigger 的模型上去做扩展解决只能获取到事件ID，而获取不到实体数据的问题。不过我在分析过 Gmail 的事件机制后，发现它的通过轮询和订阅两种方式拿到的都只有事件ID，而不是实体数据，觉得应该存在统一解决方案。所以向项目负责人说过之后，他觉得确实是这样的，让我可以朝这个方向设计。
- 具体设计方案：
	当时设计了三种模型方案来解决，前两种方案是我有些拿不准 Trigger 模型的职责边界是否包含将事件ID丰富为实体数据。
	1. 方案一：第一种方案是原来 PollingTrigger 它组合了一个 DataFetcher 模型用于在轮询时向第三方接口拉取数据，就将 DataFetcher 设计为策略模式，并增加一个可以获取事件ID后获取对应实体数据的实现，同时让 InstantTrigger 也组合 DataFetcher，解决两者缺少的能力。
	2. 方案二：单独设计一个 DataEnricher 模型，它的职责是丰富数据。Trigger 只负责事件的触发，不去关心所获取的事件是否是丰富的。在应用层当 Trigger 触发获取到事件ID后，交给 DataEnricher 去负责丰富数据。
	3. 方案三：一种兜底方案。在方案评审结束后，需要对方案的成本进行评估，因为本次需求是跨部门要接入我们的 Trigger，所以几乎没有 buffer，兜底方案应对风险。



# 整体实习经历问题

## 技术架构

1. 在多个技术方案中做决策时，你的评估框架是什么？如何平衡技术先进性与业务交付压力？

## 工程方法论

1. 你是否有自己总结的问题解决方法论？在面对复杂技术问题时，你的分析思路是什么？
	基本分成四个步骤：明确和界定问题、定位拆解成子问题、设计解决方案和执行、最后复盘沉淀。
	具体讲讲如下：
	1. 明确和界定问题 - 确保问题解决的方向是正确的
	>  首先我不会立刻跳进去设计或者写代码查bug。我认为解决问题最重要的一步是精确地定义问题
	




3. 除了单元测试，你在代码质量保障方面还有哪些实践？如何推动团队建立质量意识？


## 业务与成长

1. 如何理解低代码/无代码平台的发展趋势？飞书集成平台在字节生态中的战略价值是什么？


2. 通过这个项目，你在技术视野和工程能力上最大的收获是什么？下一步计划深入哪个技术方向？


# 技术点问题

## 1. G2 InstantTrigger 开发态模型设计

### 1. 架构设计深度

1. 原有基于 extra 字段的方案存在哪些具体问题？除了可维护性，在数据类型安全、序列化效率、版本兼容性方面有何痛点？
> 	

2. 你的接口抽象是如何平衡通用性与特异性的？如何设计接口方法才能避免后续的频繁变更？
> 	抽象思路的话，主要是分层去抽象。对于最上层的核心父类接口，保证只定义最基础的 Trigger 接口，比如获取 ID、Type 等；然后下一层可以定义 InstatTrigger 和 PollingTrigger 的接口应具备的特异性行为；后续可以基于这两个 Trigger 接口继续下一层次的设计具体实现。
>	 对于经常变更的接口方法，起方法参数可以使用 Context 对象，便于扩展。以及可以预留 Hook 点，便于扩展处理。同时也符合开闭原则。


	追问：
	1. 现在要新增一个混合型触发器（既有即时又有轮询特性），你的设计如何支持？
		可以组合复用原有 Polling 和 Instant 的能力，假设可以叫 ComplexTrigger，可以基于 Polling 和 Instant 的能力实现自己需要的能力。

	2. 在接口设计中如何处理可选的方法实现？
		提供空实现即可。


### 2. 技术实现细节

1. 在多态设计中，你是如何管理具体实现的注册与发现的？是否使用了工厂模式、SPI机制或其他设计模式？
	> 没有通过设计模式去做具体实现的注册发现。因为在配置化开发时知道具体要构造什么类型的 Trigger，同时构造 Trigger 需要输入的参数较多，所以选择采用建造者模式去做构造更加合适和方便。

2. 在配置化开发中，如何保证配置的正确性？有没有实现配置的验证机制？
> 	有的。有两种验证的触发机制：
> 		- 第一种是在首次创建 TriggerDraft 时，TriggerDraft 在构造时其本身以及其值对象会判断必要字段的存在以及合法性。
> 		- 第二种是在修改 TriggerDraft 配置时，通过 TriggerDraft 的 Validate 方法对可修改的字段进行校验。

	追问：
		1. 验证失败时的错误信息时如何设计的？是否支持国际化？
			

### 3. 质量保障

1. 在重构过程中，如何保证新旧模型的平滑迁移？有没有设计数据迁移方案或双兼容机制？
> 首先，对于新旧模型中预期对模型的构造、修改和验证通过单测保证其原来核心逻辑的正确性。
> 其次，此次模型改动只涉及领域模型的改动，数据模型保持不变，新增的 Instant 的字段存放在 ，减少改动成本。

2. 你提到的可测试性具体体现在哪里？能否举例说明一个复杂场景的测试用例设计？
> 就如果按原来 Trigger extra 的设计。比如在对 PollingTrigger 或者 InstantTrigger 进行测试时，有些字段对于 Instant 是必填的且有校验规则，但是我在测试 Polling 的时候也不得不也对 Instant 的字段做构造。同时，反过来也是一样的道理。


## 2. Action 大附件优化问题

### 怎么讲

场景：
使用 Action 发送 Gmail 邮件时，上传 5 mb 的附件会导致调用下游服务响应超时。在 gmail 的官方文档中是推荐在单次发送邮件时附件大小在5mb左右。

任务：
在物料迁移过程中， 我主要负责整个 gmail 的模型演进、开发和迁移问题的处理。在排查该问题的时候，主要通过小范围到大范围的方式去排查，先用go写了一个http请求，确认了手动调用 gmail 的开放 api 是可以发送 5mb 大小附件的邮件。
然后，尝试直接生成好数据，用postman调用测试环境的接口，也没有超时。这个时候，确认谷歌官方和本地测试接口都是没问题的，可能是在对邮件数据处理有问题。

在处理邮件数据的js插件中，主要的时间复杂度在于对邮件信息的 base64 处理（这个是谷歌官方要求的），我通过硬编码的方式讲5mb邮件base64后注入到js代码中，发现调用正常。这个时候就定位好了问题所在。

对于优化方案，一种是前端对js引擎引入更高效的库函数来处理，另一种是base64的过程交由go来处理，通过定义转换函数的命名空间和函数名异步执行。


## 3. 高并发场景下的解决方案

 分层处理：
 1. 流量进入工作流前的限流做缓冲处理；

### 1. 流量入口的拦截与缓冲

高并发的含义是指“短时间内触发请求远超系统处理能力”，第一步需要在流量进入工作流之前进行“拦截缓冲”。

#### 1. 前置限制流量

#### 2. 消息队列削峰：缓冲突发流量



