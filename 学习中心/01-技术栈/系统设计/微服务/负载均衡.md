# 两种负载均衡
## 服务端负载均衡
主要应用于**系统外部请求**和**网关层**之间，可以使用软件或硬件实现。
## 客户端负载均衡
在客户端处维护服务端列表，通过一定的负载均衡算法选择一台服务端处理请求。
# 负载均衡算法
## 随机法
分为*未加权随机*和*加权随机*
**缺点**：
> 部分机器一段时间内无法被随机到，即便权重一样，因为随机性，也会有这种情况。

### 两次随机算法
两次随机算法在随机法的基础上多增加一次随机，多选出一台服务器。随后根据两台服务器的负载等情况，从中选择出一个合适的服务器。
**优点**：
> 可以动态调节服务端节点负载，使其更加均衡。(一次随机，可能会导致某些服务器过载，某些服务器空闲)

## 轮询法
分为*未加权轮询*和*加权轮询*
加权轮询算法适用于服务器性能不等的集群，权重的存在可以使请求分配更加合理化。
在加权轮询的基础上，进行优化的算法如平滑的加权轮询算法。

## 哈希法
将请求参数信息通过哈希函数转换成一个哈希值，根据哈希值来决定选择哪台服务器处理请求。

在服务器数量不变的情况下，相同参数的请求会发送到同一台服务器处理(比如同IP请求、同用户请求)。

### 一致性哈希法
将数据和节点都映射到一个哈希环上，根据哈希值顺序来确定数据属于哪个节点。

**优点**：
> 解决了哈希法在服务器发生数量变化时，哈希值会重新落在不同的服务器上，导致违背hash法可以让相同的参数的请求总是发送到同一服务器处理的目的。

简而言之，就是当服务器增删时，只影响该服务器的哈希，而不会导致整个服务集群的哈希键值重新分布。

## 最小连接法
以**连接数**为标准。
遍历服务器节点列表并选取其中连接数最小的一台服务器来响应请求。相同连接的情况下，可以进行加权随机。

**缺点**：
这是基于一个服务器连接数越多，负载越高假设。
然而，实际情况不一定是这样的。
 
## 最少活跃法
以**活动连接数**(正在处理的请求数)为标准。
活跃数越低，说明处理能力越强，这样就可以使处理能力强的服务器处理更多请求。
相同活跃数的情况下，可以进行加权随机。

## 最快响应时间法
以**响应时间**为标准。
客户端会维持每个服务器的响应时间，每次挑选响应时间最短的。相同响应时间下，可以进行加权随机。

**缺点**：
> 可能会造成流量集中于高性能服务器。




