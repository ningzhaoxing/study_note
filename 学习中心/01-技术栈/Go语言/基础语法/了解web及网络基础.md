# 使用HTTP协议访问Web

通过发送请求获取服务器资源的Web浏览器等，被成为客户端(client)。

![[20241115183641.png]]

Web使用一种名为HTTP(超文本传输协议)的协议作为规范，完成从客户端到服务器端等一系列运作流程。

> 可以说，Web是建立在HTTP协议上通信的。

# 网络基础TCP/IP

 通常使用的网络(包括互联网)都是在TCP/IP协议族的基础上运作的。
 而HTTP属于它内部的一个**子集**。

## TCP/IP协议族

不同硬件、操作系统之间的通信，所有的一切都需要一种规则，我们把这种规则成为**协议**。

## TCP/IP的分层管理

TCP/IP协议族按层次分别分为一下4层:**应用层**、**传输层**、**网络层**和**数据链路层**。

TCP/IP协议族各层的作用如下:

### 应用层

应用层决定了向用户提供应用服务时通信的活动。
TCP/IP协议族内预存了各类通用的应用服务。比如**FTP（文件传输协议）**和 **DNS（域名系统）服务**就是其中两类。

HTTP协议也处于该层。

### 传输层

传输层对应上层应用层，提供处于网络连接中的两台计算机之间的数据传输。

在传输层，有两个性质不同的协议:**TCP**(传输控制协议)和**UDP**(用户数据报协议)

### 网络层

网络层用来处理在网络上流动的数据包。
> 数据包是网络传输的最小数据单位。

该层规定了通过怎样的路径(传输线路)到达对方计算机，并把数据包传送给对方。

### 链路层

用来处理连接网络的硬件部分。

## TCP/IP通信传输流

![[20241115163438.png]]

### 传输过程

1. 首先发送端的客户端在应用层(HTTP协议)发出一个想看某个Web页面的HTTP请求。
2. 接着在传输层(TCP协议)把从应用层收到的数据(HTTP请求报文)进行**分割**并在各个报文上打上**标记序号**及**端口号**转发给网络层。
3. 在网络层(IP协议族)，增加作为**通信目的地的MAC地址**后，转发给链路层。
4. 接收端的雾浮起在链路层接收数据，按序往上层发布，一直到应用层。此时才算真正接收到客户端发送过来的HTTP请求。

![[20241115164324.png]]

发送端在层与层之间传输数据前，都会打上一个该层所属的首部信息。反之，接收端则会将每层对应的首部消去。

> 这种把数据信息包装起来的做法称为封装。

# 与HTTP关系密切的协议:IP、TCP和DNS

## 负责传输的IP协议

IP网际协议位于**网络层**。

IP协议的作用是**把各种数据包传送给对方**。
而要保证确实传送到对方那里，则需要满足各类条件。其中两个重要的条件是**IP地址**和**MAC地址**。

> - IP地址指明了节点被分配到的地址;MAC地址是指网卡所属的固定地址。
> - IP地址可以和MAC地址进行配对。
> - IP地址可变换，但MAC地址基本不会更改。

### 使用ARP协议凭借MAC地址进行通信

IP间的通信依赖MAC地址。
在网络上，通信的双方通常是经过多台计算机和网络设备中转才能连接到对方。而在进行中转时，会利用下一站**中转设备的MAC地址**来搜索下一个中转目标。
这时会采用ARP协议。

> ARP是一种用以解析地址的协议，根据通信双方的IP地址就可以反查出对方的MAC地址。

## 确保可靠性的TCP协议

TCP协议位于**传输层**，提供可靠的字节流服务。

> 字节流服务是指，将大块数据分割成以**报文段**为单位的数据包进行管理。
> 可靠的字节流服务是指，能够把数据准确可靠地传给对方。

总之，TCP协议为了更容易传送大数据才把数据分割，而且TCP协议能够确认数据最终是否送达到对方。

### 确保数据能到达目标

为了准确无误地将数据送达目标处，TCP协议采用了**三次握手策略**。

握手过程中使用了TCP的标志(flag) —— **SYN** 和 **ACK**。

三次握手的过程:

![[20241115171418.png]]

1. 发送端首先发送一个带**SYN标志**的数据包给对方。
2. 接收端收到后，回传一个带有**SYN/ACK标志**的数据包以示传达确认信息。
3. 最后，发送端再回传一个带**ACK标志**的数据包，代表"握手"结束。
若在握手过程中某个阶段发生中断，TCP协议会再次以相同的顺序发送相同的数据包。


除了三次握手，TCP协议还有其他手段来保证通信的可靠性。

# 负责域名解析的DNS服务

DNS服务和HTTP协议一样位于**应用层**。它提供域名到IP地址之间的**解析服务**。
计算机既可以被赋予IP地址，也可以被赋予主机名和域名。比如 www.baidu.com

> 用户通常使用主机名或域名的方式来访问对方的计算机，而不是直接通过IP地址访问。
> 这是因为字母配数字的表示形式来指定计算机名更符合人类的记忆习惯。
> 
> 而计算机去理解名称却相对困难，计算机更加擅长去处理数字。

为了解决上述问题，DNS服务应运而生。
DNS协议提供通过**域名查找IP地址**，或逆向通过**IP地址反查域名**的服务。

![[20241115172912.png]]


# 各种协议与HTTP协议的关系

 通过一张图来了解IP协议、TCP协议和DNS服务在使用HTTP协议的通信过程中各自发挥的作用。
![[20241115173259.png]]


# URI和URL

## 统一资源标识符URI

URI是由某个协议方案表示的资源的定位标识符。
> 协议方案是指访问资源所使用的协议类型名称。如采用HTTP协议时，协议方案就是http。除此之外，还有ftp、mailto、telnet、file等。

URI用字符串标识某一互联网资源，而URL标识资源的地点(互联网上所处的位置)。因此，
**URL时URI的子集**。

“RFC3986：统一资源标识符（URI）通用语法”中列举了几种 URI 例子，如下所示。
![[20241115174033.png]]


## URI格式

表示指定的URI，要使用涵盖*全部必要信息*的**绝对URI**、**绝对URL**以及**相对URL**。
> 相对URL是指，从浏览器中基本URI处指定的URL，形如 /image/logo.gif

### 下面是绝对URI格式:

![[20241115180245.png]]

#### 协议方案名

使用`http:`或`https:`等协议方案名获取访问资源时，要指定协议类型。不区分字母大小写，最后附上一个冒号(:)。

#### 登录信息(认证)

指定用户名和密码作为从服务器端获取资源时必要的登录信息（身份认证）。此项是可选项。

#### 服务器地址

使用绝对 URI 必须指定待访问的服务器地址。地址可以是类似hackr.jp 这种 DNS 可解析的名称，或是 192.168.1.1 这类 IPv4 地址名，还可以是 [0:0:0:0:0:0:0:1] 这样用方括号括起来的 IPv6 地址名。

#### 服务端口号

指定服务器连接的网络端口号。此项也是可选项，若用户省略则自动使用默认端口号。

#### 带层次的文件路径

指定服务器上的文件路径来定位特指的资源。

#### 查询字符串

针对已指定的文件路径内的资源，可以使用查询字符串传入任意参数。此项可选。

#### 片段标识符

使用片段标识符通常可标记出已获取资源中的子资源（文档内的某个位置）。但在 RFC 中并没有明确规定其使用方法。该项也为可选项。