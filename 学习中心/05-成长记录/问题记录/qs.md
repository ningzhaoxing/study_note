先简单讲一下目前对架构的理解。

![[app-arch.png]]
1. 这个“单个业务模块和多个业务模块”是怎么划分的，我们这个需求是单个还是多个业务模块？
2. Infrastructure API “耦合具体技术”是什么意思(比如 mysql 吗)？
3. 起名字会又些纠结，文件和接口定义的起名字应该从哪些方面入手和考虑(变量的定义尤其作用域内的见名知义)？
4. 两种架构的核心思想是把“外部请求预处理”、“业务逻辑”、“具体技术实现”、“外部sdk封装”这几部分进行分开处理。

Answer：
1. 设计基础组件 sdk 的，应该是放在 `infra` 进行封装一层。
2. 命名问题：文件 `span_repo` 应该还要指明其与 `trace` 的关系，应该为 `trace_span_repo`。否则如果其它业务也用到了 `span` 这个概念会导致混淆不清；接口定义 `ISpanRepo` 也是同样的问题，需要指明与 `trace` 的关联；方法定义 `BatchAdd()`，这个批量添加 `span` 在当前场景，应该需要说清楚怎么添加的，比如以后可能会存在通过其他方式批量添加怎么办呢？应该是通过 `trace_id` 批量添加，改为 `BatchAddByTraceID()`。
	![[5da67ad7e6680d66ea074c05f96ccef8.jpg]]
3. diven adapters 是在 `infra` 层和 `facade` 、 `module` 层之间的适配器。`rmq` 目录实际应该对应的是`rest handler` 。因为并不存在业务逻辑，这里的 `ITraceSpanRepo` 的具体实现应该放在 `drivenAdapter` 层。


# 总结
1. 命名问题：核心是要用简单的单词拼接来描述清楚文件的语义。
	1. 文件名、接口签名等需要根据当前业务作用域来分析关系。
	2. 方法名、变量名需要考虑的作用域会小些，详细注明当前方法或变量在当前上下文的操作和作用。
2. 架构分层：
	1. “外部请求预处理”、“业务逻辑”、“具体技术实现”、“外部sdk封装”
